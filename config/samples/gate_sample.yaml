apiVersion: konductor.io/v1
kind: Gate
metadata:
  name: processing-gate
  namespace: default
spec:
  conditions:
    - type: Job
      name: data-loader
      state: Complete
      onNotFound: wait
    - type: Semaphore
      name: api-quota
      state: Available
      value: 2
      onNotFound: fail
    - type: Barrier
      name: stage-1-complete
      state: Open
      onNotFound: wait
  timeout: 1h
  ttl: 2h
  onTimeout: fail
  retryInterval: 30s